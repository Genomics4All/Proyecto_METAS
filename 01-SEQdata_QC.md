# SEQdata QC

## Fastqc

```bash
conda activate METAS

for Strain in M1012305 M442305 M612305 M732305 M852305 P121005 P241005 P411005 P531005 P651005 T143105 T22905 T313105 T34905 M1022305 M1132305 M212305 M332305 M452305 M622305 M742305 M912305 P131005 P251005 P421005 P541005 T113105 T14905 T233105 T31905 T353105 M112305 M152305 M322305 M1052305 M122305 M242305 M412305 M532305 M652305 M822305 M942305 P211005 P331005 P451005 P621005 T12905 T213105 T24905 T333105 M1112305 M132305 M252305 M422305 M542305 M712305 M832305 M952305 P221005 P341005 P511005 P631005 T133105 T21905 T253105 T33905 M1122305 M142305 M312305 M432305 M552305 M722305 M842305 P111005 P231005 P351005 P521005 P641005 T13905 T223105 T25905 T343105 M1032305 M1142305 M222305 M342305 M512305 M632305 M752305 M922305 P141005 P311005 P431005 P551005 T11905 T153105 T23905 T323105 T35905 M1042305 M1152305 M232305 M352305 M522305 M642305 M812305 M932305 P151005 P321005 P441005 P611005 T123105 T15905 T243105 T32905; do
    RawDataF=$(ls raw_data/paired/$Strain/"$Strain"_*_1.fq.gz)
    RawDataR=$(ls raw_data/paired/$Strain/"$Strain"_*_2.fq.gz)
    echo $RawDataF;
    echo $RawDataR;
    OutDir=$(dirname $RawDataF)
    sbatch scripts/fastqc.CBGP.sh $RawDataF $OutDir
    sbatch scripts/fastqc.CBGP.sh $RawDataR $OutDir
done

# MultiQC
conda activate py3.11

Folder=raw_data/paired
OutDir=$(dirname $Folder)
sbatch scripts/multiqc.CBGP.sh $Folder $OutDir

# Copy output to local
scp -r -P 33322 agomez@138.4.139.7:raw_data/paired/multi* ./raw_data
```

## Trimmomatic

```bash
for Strain in M1012305 M442305 M612305 M732305 M852305 P121005 P241005 P411005 P531005 P651005 T143105 T22905 T313105 T34905 M1022305 M1132305 M212305 M332305 M452305 M622305 M742305 M912305 P131005 P251005 P421005 P541005 T113105 T14905 T233105 T31905 T353105 M112305 M152305 M322305 M1052305 M122305 M242305 M412305 M532305 M652305 M822305 M942305 P211005 P331005 P451005 P621005 T12905 T213105 T24905 T333105 M1112305 M132305 M252305 M422305 M542305 M712305 M832305 M952305 P221005 P341005 P511005 P631005 T133105 T21905 T253105 T33905 M1122305 M142305 M312305 M432305 M552305 M722305 M842305 P111005 P231005 P351005 P521005 P641005 T13905 T223105 T25905 T343105 M1032305 M1142305 M222305 M342305 M512305 M632305 M752305 M922305 P141005 P311005 P431005 P551005 T11905 T153105 T23905 T323105 T35905 M1042305 M1152305 M232305 M352305 M522305 M642305 M812305 M932305 P151005 P321005 P441005 P611005 T123105 T15905 T243105 T32905; do
    RawDataF=$(ls raw_data/paired/$Strain/"$Strain"_*_1.fq.gz)
    RawDataR=$(ls raw_data/paired/$Strain/"$Strain"_*_2.fq.gz)
    echo $RawDataF;
    echo $RawDataR;
    #IluminaAdapters=/home/gomeza/git_repos/scripts/bioinformatics_tools/SEQdata_qc/illumina_full_adapters.fa
    IluminaAdapters=/home/agomez/miniconda/envs/METAS/share/trimmomatic-0.39-2/adapters/NexteraPE-PE.fa 
    OutDir=qc_dna/X204SC23065283-Z01-F001/$Strain
    sbatch scripts/trimmomatic.CBGP.sh $RawDataF $RawDataR $IluminaAdapters $OutDir
done
```

## Fastqc

```bash
for Strain in M1012305 M442305 M612305 M732305 M852305 P121005 P241005 P411005 P531005 P651005 T143105 T22905 T313105 T34905 M1022305 M1132305 M212305 M332305 M452305 M622305 M742305 M912305 P131005 P251005 P421005 P541005 T113105 T14905 T233105 T31905 T353105 M112305 M152305 M322305 M1052305 M122305 M242305 M412305 M532305 M652305 M822305 M942305 P211005 P331005 P451005 P621005 T12905 T213105 T24905 T333105 M1112305 M132305 M252305 M422305 M542305 M712305 M832305 M952305 P221005 P341005 P511005 P631005 T133105 T21905 T253105 T33905 M1122305 M142305 M312305 M432305 M552305 M722305 M842305 P111005 P231005 P351005 P521005 P641005 T13905 T223105 T25905 T343105 M1032305 M1142305 M222305 M342305 M512305 M632305 M752305 M922305 P141005 P311005 P431005 P551005 T11905 T153105 T23905 T323105 T35905 M1042305 M1152305 M232305 M352305 M522305 M642305 M812305 M932305 P151005 P321005 P441005 P611005 T123105 T15905 T243105 T32905; do
    TrimmedF=$(ls qc_dna/X204SC23065283-Z01-F001/$Strain/F/"$Strain"_F_no_adapt.fq)
    TrimmedR=$(ls qc_dna/X204SC23065283-Z01-F001/$Strain/R/"$Strain"_R_no_adapt.fq)
    echo $TrimmedF;
    echo $TrimmedR;
    OutDirF=$(dirname $TrimmedF)
    OutDirR=$(dirname $TrimmedR)
    sbatch scripts/fastqc.CBGP.sh $TrimmedF $OutDirF
    sbatch scripts/fastqc.CBGP.sh $TrimmedR $OutDirR
done

# MultiQC
Folder=qc_dna/X204SC23065283-Z01-F001
OutDir=$(dirname $Folder)
sbatch scripts/multiqc.CBGP.sh $Folder $OutDir

# Copy output to local
scp -r -P 33322 agomez@138.4.139.7:qc_dna/X204SC23065283-Z01-F001/multi* ./qc_data
```

## Fastp

```bash
for Sample in M1012305 M442305 M612305 M732305 M852305 P121005 P241005 P411005 P531005 P651005 T143105 T22905 T313105 T34905 M1022305 M1132305 M212305 M332305 M452305 M622305 M742305 M912305 P131005 P251005 P421005 P541005 T113105 T14905 T233105 T31905 T353105 M112305 M152305 M322305 M1052305 M122305 M242305 M412305 M532305 M652305 M822305 M942305 P211005 P331005 P451005 P621005 T12905 T213105 T24905 T333105 M1112305 M132305 M252305 M422305 M542305 M712305 M832305 M952305 P221005 P341005 P511005 P631005 T133105 T21905 T253105 T33905 M1122305 M142305 M312305 M432305 M552305 M722305 M842305 P111005 P231005 P351005 P521005 P641005 T13905 T223105 T25905 T343105 M1032305 M1142305 M222305 M342305 M512305 M632305 M752305 M922305 P141005 P311005 P431005 P551005 T11905 T153105 T23905 T323105 T35905 M1042305 M1152305 M232305 M352305 M522305 M642305 M812305 M932305 P151005 P321005 P441005 P611005 T123105 T15905 T243105 T32905; do
for trimmed in $(ls -d qc_dna/X204SC23065283-Z01-F001/$Sample); do
    Read_F=$(ls $trimmed/F/"$Sample"_F_no_adapt.fq)
    Read_R=$(ls $trimmed/R/"$Sample"_R_no_adapt.fq)
    echo $Read_F;
    echo $Read_R;
    OutDir=qc_dna/X204SC23065283-Z01-F001/$Sample
    sbatch -p medium scripts/fastp.CBGP2.sh $Read_F $Read_R $OutDir
done
done

# FastQC
for Sample in M1012305 M442305 M612305 M732305 M852305 P121005 P241005 P411005 P531005 P651005 T143105 T22905 T313105 T34905 M1022305 M1132305 M212305 M332305 M452305 M622305 M742305 M912305 P131005 P251005 P421005 P541005 T113105 T14905 T233105 T31905 T353105 M112305 M152305 M322305 M1052305 M122305 M242305 M412305 M532305 M652305 M822305 M942305 P211005 P331005 P451005 P621005 T12905 T213105 T24905 T333105 M1112305 M132305 M252305 M422305 M542305 M712305 M832305 M952305 P221005 P341005 P511005 P631005 T133105 T21905 T253105 T33905 M1122305 M142305 M312305 M432305 M552305 M722305 M842305 P111005 P231005 P351005 P521005 P641005 T13905 T223105 T25905 T343105 M1032305 M1142305 M222305 M342305 M512305 M632305 M752305 M922305 P141005 P311005 P431005 P551005 T11905 T153105 T23905 T323105 T35905 M1042305 M1152305 M232305 M352305 M522305 M642305 M812305 M932305 P151005 P321005 P441005 P611005 T123105 T15905 T243105 T32905; do
    TrimmedF=$(ls qc_dna/X204SC23065283-Z01-F001/$Sample/F/"$Sample"_F.clean_qc_pair_trim.fq.gz)
    TrimmedR=$(ls qc_dna/X204SC23065283-Z01-F001/$Sample/R/"$Sample"_R.clean_qc_pair_trim.fq.gz)
    echo $TrimmedF;
    echo $TrimmedR;
    OutDirF=$(dirname $TrimmedF)
    OutDirR=$(dirname $TrimmedR)
    sbatch scripts/fastqc.CBGP.sh $TrimmedF $OutDirF
    sbatch scripts/fastqc.CBGP.sh $TrimmedR $OutDirR
done

# MultiQC
Folder=qc_dna/X204SC23065283-Z01-F001
OutDir=qc_dna/X204SC23065283-Z01-F001/multiqc_all
mkdir -p $OutDir
sbatch -p long scripts/multiqc.CBGP.sh $Folder $OutDir

# Copy output to local
scp -r -P 33322 agomez@138.4.139.7:qc_dna/X204SC23065283-Z01-F001/multi* ./qc_data
```